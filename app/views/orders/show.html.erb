<p id="notice"><%= notice %></p>

<div class="hotel">

<p>
  <strong>Customer name:</strong>
  <%= @order.customer_name %>
</p>
<% @products = Product.where(id: @order.product_ids)%>
<table class="table table-bordered">
	<tr>
		<th>product name</th>
		<th>Quntity</th>
		<th>price</th>
		<th>total</th>
	</tr>
	<% x = 1 %>
	<%@products&.each do |product|%>
	<tr>
		<td><%= product.name %></td>
		<td><input type="text" name="quantity" min="1" max="100" id="box1" oninput="calculate();"></td>
		<td id="box2" oninput="calculate();"><%= product.price %></td>
		<td id="result_<%= x %>"><%= product.price %></td>
	</tr>
	<%= x = x + 1 %>
	<%end%>
</table>
<div id="last" style="display: none;" ><%= x-1 %></div>
<div class="container">
	<div class="row">
		<div class="col-md-4">
	<span style="font-size: 40px;" > Grand total:</span> <span id="grand_total" class="pull-right" style="font-size: 30px;">0</span>

</div>
</div>
</div>
</div>
<button id="print" class="btn btn-danger">Print recipte</button>


<%= link_to 'Edit', edit_order_path(@order), id: "1" %> |
<%= link_to 'Back', orders_path, id: "2" %>
<script
  src="https://code.jquery.com/jquery-3.4.1.min.js"
  integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo="
  crossorigin="anonymous">
 </script>

 <script >
 	$('#print').click(function()
 	{
 		window.print();
 		document.getElementsById("1").setAttribute("class", "remove_button");
 		document.getElementsById("2").setAttribute("class", "remove_button"); 
 		document.getElementsById("print").setAttribute("class", "remove_button");  
 	});
 </script>
 <script>
    function calculate() {
        var myBox1 = document.getElementById('box1').value;
        var myBox2 = document.getElementById('box2').innerText;
       
        var myResult = myBox1 * myBox2;
        document.getElementById('result_1').innerText = myResult;
        var last = parseInt(document.getElementById('last').innerText);
       
        var i = 1;
        var plus = 0;
		for (i = 1; i < last; i++) {
			console.log(i);
		  plus +=  parseInt(document.getElementById('result_'+i).innerText);
		}

        document.getElementById('grand_total').innerText = plus;

    }
</script>